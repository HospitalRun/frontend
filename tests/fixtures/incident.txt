{"version":"1.2.5","db_type":"http","start_time":"2017-03-08T20:23:16.841Z","db_info":{"db_name":"main","doc_count":38,"doc_del_count":0,"update_seq":76,"purge_seq":0,"compact_running":false,"disk_size":249956,"data_size":28105,"instance_start_time":"1489001124939610","disk_format_version":6,"committed_update_seq":76,"host":"http://localhost:5984/main/","auto_compaction":false,"adapter":"http"}}
{"docs":[{"_id":"_design/inventory_by_friendly_id","_rev":"1-82e24378f074a284cae14da4db5431ed","version":1,"views":{"inventory_by_friendly_id":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'inventory') {\n        emit([doc.data.friendlyId, doc._id]);\n      }\n    }\n  }"}}}]}
{"seq":2}
{"docs":[{"_id":"_design/inventory_by_name","_rev":"1-91f55ae6bd30f766d9da95bffe054bcb","version":5,"views":{"inventory_by_name":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'inventory') {\n        emit([doc.data.name, doc._id]);\n      }\n    }\n  }"}},"lists":{"sort":"function(head, req) {function keysEqual(keyA, keyB) {for (var i= 0; i < keyA.length; i++) {if (keyA[i] !== keyB[i]) {return false;}}return true;}function compareStrings(aString, bString) {if (!aString) {aString = \"\";}if (!bString) {bString = \"\";}if (aString < bString) {return -1;} else if (aString > bString) {return 1;} else {return 0;}}var row,rows=[],startingPosition = 0;while(row = getRow()) {rows.push(row);}rows.sort(function (a, b) {\n      var sortBy = '';\n      if (req.query && req.query.sortKey) {\n        sortBy = req.query.sortKey;\n      }\n      switch (sortBy) {\n        case 'crossReference':\n        case 'description':\n        case 'friendlyId':\n        case 'name':\n        case 'price':\n        case 'quantity':\n        case 'inventoryType':\n          {\n            return compareStrings(a.doc.data[sortBy], b.doc.data[sortBy]);\n          }\n        default:\n          {\n            return 0; // Don't sort\n          }\n      }\n    });if (req.query.sortDesc) {rows = rows.reverse();}if (req.query.sortStartKey) {var startKey = JSON.parse(req.query.sortStartKey);for (var i=0; i<rows.length; i++) {if (keysEqual(startKey, rows[i].key)) {startingPosition = i;break;}}}if (req.query.sortLimit) {rows = rows.slice(startingPosition, parseInt(req.query.sortLimit)+startingPosition);} else if (startingPosition > 0) {rows = rows.slice(startingPosition);}send(JSON.stringify({\"rows\" : rows}));}"}}]}
{"seq":3}
{"docs":[{"_id":"_design/appointments_by_date","_rev":"1-5df29f1d7dbd39d6b3a2145923ab73cf","version":7,"views":{"appointments_by_date":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'appointment') {\n        var endDate = doc.data.endDate;\n    if (endDate && endDate !== \"\") {\n      endDate = new Date(endDate);\n      if (endDate.getTime) {\n        endDate = endDate.getTime();\n      }\n    }\n    var startDate = doc.data.startDate;\n    if (startDate && startDate !== \"\") {\n      startDate = new Date(startDate);\n      if (startDate.getTime) {\n        startDate = startDate.getTime();\n      }\n    }\n    if (doc.data.appointmentType !== 'Surgery') {\n      emit([startDate, endDate, doc._id]);\n    }\n      }\n    }\n  }"}},"lists":{"sort":"function(head, req) {function keysEqual(keyA, keyB) {for (var i= 0; i < keyA.length; i++) {if (keyA[i] !== keyB[i]) {return false;}}return true;}function getCompareDate(dateString) {if (!dateString || dateString === \"\") {return 0;}return new Date(dateString).getTime();}function compareStrings(aString, bString) {if (!aString) {aString = \"\";}if (!bString) {bString = \"\";}if (aString < bString) {return -1;} else if (aString > bString) {return 1;} else {return 0;}}var row,rows=[],startingPosition = 0;while(row = getRow()) {rows.push(row);}rows = rows.filter(function (row) {\n    var filterBy = null;\n    var includeRow = true;\n    if (req.query && req.query.filterBy) {\n      filterBy = JSON.parse(req.query.filterBy);\n    }\n    if (!filterBy) {\n      return true;\n    }\n    for (var i = 0; i < filterBy.length; i++) {\n      var currentValue = row.doc.data[filterBy[i].name];\n      if (filterBy[i].name === 'status' && (!currentValue || currentValue === '')) {\n        currentValue = 'Scheduled';\n      }\n      if (currentValue !== filterBy[i].value) {\n        includeRow = false;\n        break;\n      }\n    }\n    return includeRow;\n  });rows.sort(function (a, b) {\n    function defaultStatus(value) {\n      if (!value || value === '') {\n        return 'Scheduled';\n      } else {\n        return value;\n      }\n    }\n    var sortBy = '';\n    if (req.query && req.query.sortKey) {\n      sortBy = req.query.sortKey;\n    }\n    switch (sortBy) {\n      case 'appointmentType':\n      case 'location':\n      case 'provider':\n        return compareStrings(a.doc.data[sortBy], b.doc.data[sortBy]);\n      case 'date':\n        {\n          var startDiff = getCompareDate(a.doc.data.startDate) - getCompareDate(b.doc.data.startDate);\n          if (startDiff === 0) {\n            return getCompareDate(a.doc.data.endDate) - getCompareDate(b.doc.data.endDate);\n          } else {\n            return startDiff;\n          }\n        }\n      case 'status':\n        {\n          var aStatus = defaultStatus(a.doc.data[sortBy]);\n          var bStatus = defaultStatus(b.doc.data[sortBy]);\n          return compareStrings(aStatus, bStatus);\n        }\n      default:\n        {\n          return 0; // Don't sort\n        }\n    }\n  });if (req.query.sortDesc) {rows = rows.reverse();}if (req.query.sortStartKey) {var startKey = JSON.parse(req.query.sortStartKey);for (var i=0; i<rows.length; i++) {if (keysEqual(startKey, rows[i].key)) {startingPosition = i;break;}}}if (req.query.sortLimit) {rows = rows.slice(startingPosition, parseInt(req.query.sortLimit)+startingPosition);} else if (startingPosition > 0) {rows = rows.slice(startingPosition);}send(JSON.stringify({\"rows\" : rows}));}"}},{"_id":"_design/appointments_by_patient","_rev":"1-9a97acd5b8fd071ad81afc9e730721c5","version":4,"views":{"appointments_by_patient":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'appointment') {\n        var endDate = doc.data.endDate;\n    if (endDate && endDate !== \"\") {\n      endDate = new Date(endDate);\n      if (endDate.getTime) {\n        endDate = endDate.getTime();\n      }\n    }\n    var startDate = doc.data.startDate;\n    if (startDate && startDate !== \"\") {\n      startDate = new Date(startDate);\n      if (startDate.getTime) {\n        startDate = startDate.getTime();\n      }\n    }\n    emit([doc.data.patient, startDate, endDate,doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/closed_incidents_by_user","_rev":"1-bf16176c13be57af9a4f1a0980710190","version":1,"views":{"closed_incidents_by_user":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'incident') {\n        if (doc.data.status === \"Closed\") {\n      emit([doc.data.reportedBy, doc._id]);\n    }\n      }\n    }\n  }"}}},{"_id":"_design/custom_form_by_type","_rev":"1-ddf0ee75c1e8e859d821a9f5c1ec43b6","version":1,"views":{"custom_form_by_type":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'customForm') {\n        emit(doc.data.formType);\n      }\n    }\n  }"}}},{"_id":"_design/imaging_by_status","_rev":"1-1a3bab3d2d1403299a9e4ad8dffe5fa1","version":4,"views":{"imaging_by_status":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'imaging') {\n        var imagingDate = doc.data.imagingDate;\n    if (imagingDate && imagingDate !== \"\") {\n      imagingDate = new Date(imagingDate);\n      if (imagingDate.getTime) {\n        imagingDate = imagingDate.getTime();\n      }\n    }\n    var requestedDate = doc.data.requestedDate;\n    if (requestedDate && requestedDate !== \"\") {\n      requestedDate = new Date(requestedDate);\n      if (requestedDate.getTime) {\n        requestedDate = requestedDate.getTime();\n      }\n    }\n    emit([doc.data.status, requestedDate, imagingDate, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/incident_by_date","_rev":"1-59fa59734ee129cff0560b20a95d2d4e","version":1,"views":{"incident_by_date":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'incident') {\n        var dateOfIncident = doc.data.dateOfIncident;\n    if (dateOfIncident && dateOfIncident !== \"\") {\n      dateOfIncident = new Date(dateOfIncident);\n      if (dateOfIncident.getTime) {\n        dateOfIncident = dateOfIncident.getTime();\n      }\n    }\n    emit([dateOfIncident, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/incident_by_friendly_id","_rev":"1-885a12b67da47e956bc190fe1fe0d4e6","version":1,"views":{"incident_by_friendly_id":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'incident') {\n        emit([doc.data.friendlyId, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/inventory_by_type","_rev":"1-18455500e1e86544edceaab01bb511bc","version":5,"views":{"inventory_by_type":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'inventory') {\n        emit(doc.data.inventoryType);\n      }\n    }\n  }"}}},{"_id":"_design/inventory_purchase_by_date_received","_rev":"1-0d7b597aeae746589980b12903768252","version":5,"views":{"inventory_purchase_by_date_received":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'invPurchase') {\n        var dateReceived = doc.data.dateReceived;\n    if (dateReceived && dateReceived !== \"\") {\n      dateReceived = new Date(dateReceived);\n      if (dateReceived.getTime) {\n        dateReceived = dateReceived.getTime();\n      }\n    }\n    emit([dateReceived, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/inventory_purchase_by_expiration_date","_rev":"1-1f41dd6d030c58884d7013ef9436decb","version":5,"views":{"inventory_purchase_by_expiration_date":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'invPurchase') {\n        var expirationDate = doc.data.expirationDate;\n    if (expirationDate && expirationDate !== \"\") {\n      expirationDate = new Date(expirationDate);\n      if (expirationDate.getTime) {\n        expirationDate = expirationDate.getTime();\n      }\n    }\n    emit([expirationDate, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/inventory_request_by_item","_rev":"1-021f4c24b5b6202594f610cf5d4c63a4","version":5,"views":{"inventory_request_by_item":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'invRequest') {\n        var dateCompleted = doc.data.dateCompleted;\n    if (dateCompleted && dateCompleted !== \"\") {\n      dateCompleted = new Date(dateCompleted);\n      if (dateCompleted.getTime) {\n        dateCompleted = dateCompleted.getTime();\n      }\n    }\n    emit([doc.data.inventoryItem, doc.data.status, dateCompleted]);\n      }\n    }\n  }"}}},{"_id":"_design/inventory_request_by_status","_rev":"1-cc0c1e0e01060aa62456d6ea768d8ec7","version":5,"views":{"inventory_request_by_status":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'invRequest') {\n        var dateCompleted = doc.data.dateCompleted;\n    if (dateCompleted && dateCompleted !== \"\") {\n      dateCompleted = new Date(dateCompleted);\n      if (dateCompleted.getTime) {\n        dateCompleted = dateCompleted.getTime();\n      }\n    }\n    emit([doc.data.status, dateCompleted, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/invoice_by_patient","_rev":"1-9f67a58d4e428614844ac82cb2548268","version":1,"views":{"invoice_by_patient":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'invoice') {\n        emit(doc.data.patient);\n      }\n    }\n  }"}}},{"_id":"_design/invoice_by_status","_rev":"1-d411e6f66f897f0b9b985dc6e5188d85","version":4,"views":{"invoice_by_status":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'invoice') {\n        var billDate = doc.data.billDate;\n    if (billDate && billDate !== \"\") {\n      billDate = new Date(billDate);\n      if (billDate.getTime) {\n        billDate = billDate.getTime();\n      }\n    }\n    emit([doc.data.status, billDate, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/lab_by_status","_rev":"1-7d4de6e219b482171b7ecd485ef72238","version":4,"views":{"lab_by_status":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'lab') {\n        var labDate = doc.data.labDate;\n    if (labDate && labDate !== \"\") {\n      labDate = new Date(labDate);\n      if (labDate.getTime) {\n        labDate = labDate.getTime();\n      }\n    }\n    var requestedDate = doc.data.requestedDate;\n    if (requestedDate && requestedDate !== \"\") {\n      requestedDate = new Date(requestedDate);\n      if (requestedDate.getTime) {\n        requestedDate = requestedDate.getTime();\n      }\n    }\n    emit([doc.data.status, requestedDate, labDate, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/medication_by_status","_rev":"1-a6403c53b2db46905b3b1861120c6601","version":4,"views":{"medication_by_status":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'medication') {\n        var prescriptionDate = doc.data.prescriptionDate;\n    if (prescriptionDate && prescriptionDate !== \"\") {\n      prescriptionDate = new Date(prescriptionDate);\n      if (prescriptionDate.getTime) {\n        prescriptionDate = prescriptionDate.getTime();\n      }\n    }\n    var requestedDate = doc.data.requestedDate;\n    if (requestedDate && requestedDate !== \"\") {\n      requestedDate = new Date(requestedDate);\n      if (requestedDate.getTime) {\n        requestedDate = requestedDate.getTime();\n      }\n    }\n    emit([doc.data.status, requestedDate, prescriptionDate, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/open_incidents_by_user","_rev":"1-34770efd210920a30c96d3787521e8a5","version":1,"views":{"open_incidents_by_user":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'incident') {\n        if (doc.data.status !== \"Closed\") {\n      emit([doc.data.reportedBy, doc._id]);\n    }\n      }\n    }\n  }"}},"lists":{"sort":"function(head, req) {function keysEqual(keyA, keyB) {for (var i= 0; i < keyA.length; i++) {if (keyA[i] !== keyB[i]) {return false;}}return true;}function compareStrings(aString, bString) {if (!aString) {aString = \"\";}if (!bString) {bString = \"\";}if (aString < bString) {return -1;} else if (aString > bString) {return 1;} else {return 0;}}var row,rows=[],startingPosition = 0;while(row = getRow()) {rows.push(row);}rows.sort(function (a, b) {\n      var sortBy = '';\n      if (req.query && req.query.sortKey) {\n        sortBy = req.query.sortKey;\n        return compareStrings(a.doc.data[sortBy], b.doc.data[sortBy]);\n      }\n      return 0; // Don't sort\n    });if (req.query.sortDesc) {rows = rows.reverse();}if (req.query.sortStartKey) {var startKey = JSON.parse(req.query.sortStartKey);for (var i=0; i<rows.length; i++) {if (keysEqual(startKey, rows[i].key)) {startingPosition = i;break;}}}if (req.query.sortLimit) {rows = rows.slice(startingPosition, parseInt(req.query.sortLimit)+startingPosition);} else if (startingPosition > 0) {rows = rows.slice(startingPosition);}send(JSON.stringify({\"rows\" : rows}));}"}},{"_id":"_design/patient_by_admission","_rev":"1-3c2da4380d257c95ebf4430afa48de3b","version":4,"views":{"patient_by_admission":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'patient') {\n        if (doc.data.admitted === true) {\n      if (doc.data.friendlyId) {\n    emit([doc.data.friendlyId, doc._id]);\n  } else if (doc.data.externalPatientId) {\n    emit([doc.data.externalPatientId, doc._id]);\n  } else {\n    emit([doc._id, doc._id]);\n }\n    }\n      }\n    }\n  }"}},"lists":{"sort":"function(head, req) {function keysEqual(keyA, keyB) {for (var i= 0; i < keyA.length; i++) {if (keyA[i] !== keyB[i]) {return false;}}return true;}function getCompareDate(dateString) {if (!dateString || dateString === \"\") {return 0;}return new Date(dateString).getTime();}function compareStrings(aString, bString) {if (!aString) {aString = \"\";}if (!bString) {bString = \"\";}if (aString < bString) {return -1;} else if (aString > bString) {return 1;} else {return 0;}}var row,rows=[],startingPosition = 0;while(row = getRow()) {rows.push(row);}rows.sort(function (a, b) {\n    var sortBy = '';\n    if (req.query && req.query.sortKey) {\n      sortBy = req.query.sortKey;\n    }\n    switch (sortBy) {\n      case 'firstName':\n      case 'sex':\n      case 'lastName':\n      case 'status':\n        {\n          return compareStrings(a.doc.data[sortBy], b.doc.data[sortBy]);\n        }\n      case 'dateOfBirth':\n        {\n          return getCompareDate(a.doc.data.dateOfBirth) - getCompareDate(b.doc.data.dateOfBirth);\n        }\n      default:\n        {\n          return 0; // Don't sort\n        }\n    }\n  });if (req.query.sortDesc) {rows = rows.reverse();}if (req.query.sortStartKey) {var startKey = JSON.parse(req.query.sortStartKey);for (var i=0; i<rows.length; i++) {if (keysEqual(startKey, rows[i].key)) {startingPosition = i;break;}}}if (req.query.sortLimit) {rows = rows.slice(startingPosition, parseInt(req.query.sortLimit)+startingPosition);} else if (startingPosition > 0) {rows = rows.slice(startingPosition);}send(JSON.stringify({\"rows\" : rows}));}"}},{"_id":"_design/patient_by_display_id","_rev":"1-8a6930002af6d588ecdedd5f07da0230","version":7,"views":{"patient_by_display_id":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'patient') {\n        if (doc.data.friendlyId) {\n    emit([doc.data.friendlyId, doc._id]);\n  } else if (doc.data.externalPatientId) {\n    emit([doc.data.externalPatientId, doc._id]);\n  } else {\n    emit([doc._id, doc._id]);\n }\n      }\n    }\n  }"}},"lists":{"sort":"function(head, req) {function keysEqual(keyA, keyB) {for (var i= 0; i < keyA.length; i++) {if (keyA[i] !== keyB[i]) {return false;}}return true;}function getCompareDate(dateString) {if (!dateString || dateString === \"\") {return 0;}return new Date(dateString).getTime();}function compareStrings(aString, bString) {if (!aString) {aString = \"\";}if (!bString) {bString = \"\";}if (aString < bString) {return -1;} else if (aString > bString) {return 1;} else {return 0;}}var row,rows=[],startingPosition = 0;while(row = getRow()) {rows.push(row);}rows.sort(function (a, b) {\n    var sortBy = '';\n    if (req.query && req.query.sortKey) {\n      sortBy = req.query.sortKey;\n    }\n    switch (sortBy) {\n      case 'firstName':\n      case 'sex':\n      case 'lastName':\n      case 'status':\n        {\n          return compareStrings(a.doc.data[sortBy], b.doc.data[sortBy]);\n        }\n      case 'dateOfBirth':\n        {\n          return getCompareDate(a.doc.data.dateOfBirth) - getCompareDate(b.doc.data.dateOfBirth);\n        }\n      default:\n        {\n          return 0; // Don't sort\n        }\n    }\n  });if (req.query.sortDesc) {rows = rows.reverse();}if (req.query.sortStartKey) {var startKey = JSON.parse(req.query.sortStartKey);for (var i=0; i<rows.length; i++) {if (keysEqual(startKey, rows[i].key)) {startingPosition = i;break;}}}if (req.query.sortLimit) {rows = rows.slice(startingPosition, parseInt(req.query.sortLimit)+startingPosition);} else if (startingPosition > 0) {rows = rows.slice(startingPosition);}send(JSON.stringify({\"rows\" : rows}));}"}},{"_id":"_design/patient_by_status","_rev":"1-54bc74ff93db4aedff83bc649f766596","version":3,"views":{"patient_by_status":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'patient') {\n        emit(doc.data.status);\n      }\n    }\n  }"}}},{"_id":"_design/photo_by_patient","_rev":"1-6a4fad4fa682efbbd058e858c328574f","version":4,"views":{"photo_by_patient":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'photo') {\n        emit(doc.data.patient);\n      }\n    }\n  }"}}},{"_id":"_design/pricing_by_category","_rev":"1-3d703b5f240ae5838d1f20a8ad0471de","version":5,"views":{"pricing_by_category":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'pricing') {\n        emit([doc.data.category, doc.data.name, doc.data.pricingType, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/procedure_by_date","_rev":"1-a44decd8f14d01c615cf3f5b8e70f10b","version":4,"views":{"procedure_by_date":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'procedure') {\n        var procedureDate = doc.data.procedureDate;\n    if (procedureDate && procedureDate !== \"\") {\n      procedureDate = new Date(procedureDate);\n      if (procedureDate.getTime) {\n        procedureDate = procedureDate.getTime();\n      }\n    }\n    emit([procedureDate, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/sequence_by_prefix","_rev":"1-10f81c9287f2db782b8e293e7d9b1cde","version":4,"views":{"sequence_by_prefix":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'sequence') {\n        emit(doc.data.prefix);\n      }\n    }\n  }"}}},{"_id":"_design/surgical_appointments_by_date","_rev":"1-90d8de834de1fe0e154d1cdab8889984","version":1,"views":{"surgical_appointments_by_date":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'appointment') {\n        var endDate = doc.data.endDate;\n    if (endDate && endDate !== \"\") {\n      endDate = new Date(endDate);\n      if (endDate.getTime) {\n        endDate = endDate.getTime();\n      }\n    }\n    var startDate = doc.data.startDate;\n    if (startDate && startDate !== \"\") {\n      startDate = new Date(startDate);\n      if (startDate.getTime) {\n        startDate = startDate.getTime();\n      }\n    }\n    if (doc.data.appointmentType === 'Surgery') {\n      emit([startDate, endDate, doc._id]);\n    }\n      }\n    }\n  }"}},"lists":{"sort":"function(head, req) {function keysEqual(keyA, keyB) {for (var i= 0; i < keyA.length; i++) {if (keyA[i] !== keyB[i]) {return false;}}return true;}function getCompareDate(dateString) {if (!dateString || dateString === \"\") {return 0;}return new Date(dateString).getTime();}function compareStrings(aString, bString) {if (!aString) {aString = \"\";}if (!bString) {bString = \"\";}if (aString < bString) {return -1;} else if (aString > bString) {return 1;} else {return 0;}}var row,rows=[],startingPosition = 0;while(row = getRow()) {rows.push(row);}rows = rows.filter(function (row) {\n    var filterBy = null;\n    var includeRow = true;\n    if (req.query && req.query.filterBy) {\n      filterBy = JSON.parse(req.query.filterBy);\n    }\n    if (!filterBy) {\n      return true;\n    }\n    for (var i = 0; i < filterBy.length; i++) {\n      var currentValue = row.doc.data[filterBy[i].name];\n      if (filterBy[i].name === 'status' && (!currentValue || currentValue === '')) {\n        currentValue = 'Scheduled';\n      }\n      if (currentValue !== filterBy[i].value) {\n        includeRow = false;\n        break;\n      }\n    }\n    return includeRow;\n  });rows.sort(function (a, b) {\n    function defaultStatus(value) {\n      if (!value || value === '') {\n        return 'Scheduled';\n      } else {\n        return value;\n      }\n    }\n    var sortBy = '';\n    if (req.query && req.query.sortKey) {\n      sortBy = req.query.sortKey;\n    }\n    switch (sortBy) {\n      case 'appointmentType':\n      case 'location':\n      case 'provider':\n        return compareStrings(a.doc.data[sortBy], b.doc.data[sortBy]);\n      case 'date':\n        {\n          var startDiff = getCompareDate(a.doc.data.startDate) - getCompareDate(b.doc.data.startDate);\n          if (startDiff === 0) {\n            return getCompareDate(a.doc.data.endDate) - getCompareDate(b.doc.data.endDate);\n          } else {\n            return startDiff;\n          }\n        }\n      case 'status':\n        {\n          var aStatus = defaultStatus(a.doc.data[sortBy]);\n          var bStatus = defaultStatus(b.doc.data[sortBy]);\n          return compareStrings(aStatus, bStatus);\n        }\n      default:\n        {\n          return 0; // Don't sort\n        }\n    }\n  });if (req.query.sortDesc) {rows = rows.reverse();}if (req.query.sortStartKey) {var startKey = JSON.parse(req.query.sortStartKey);for (var i=0; i<rows.length; i++) {if (keysEqual(startKey, rows[i].key)) {startingPosition = i;break;}}}if (req.query.sortLimit) {rows = rows.slice(startingPosition, parseInt(req.query.sortLimit)+startingPosition);} else if (startingPosition > 0) {rows = rows.slice(startingPosition);}send(JSON.stringify({\"rows\" : rows}));}"}},{"_id":"_design/visit_by_date","_rev":"1-db61f993a1e1699c8205fee3434fc4c8","version":4,"views":{"visit_by_date":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'visit') {\n        var endDate = doc.data.endDate;\n    if (endDate && endDate !== \"\") {\n      endDate = new Date(endDate);\n      if (endDate.getTime) {\n        endDate = endDate.getTime();\n      }\n    }\n    var startDate = doc.data.startDate;\n    if (startDate && startDate !== \"\") {\n      startDate = new Date(startDate);\n      if (startDate.getTime) {\n        startDate = startDate.getTime();\n      }\n    }\n    emit([startDate, endDate, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/visit_by_discharge_date","_rev":"1-b4baca85d54e727966aeb2e8ad172136","version":2,"views":{"visit_by_discharge_date":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'visit') {\n        var endDate = doc.data.endDate;\n    if (endDate && endDate !== \"\") {\n      endDate = new Date(endDate);\n      if (endDate.getTime) {\n        endDate = endDate.getTime();\n      }\n    }\n    emit([endDate, doc._id]);\n      }\n    }\n  }"}}},{"_id":"_design/visit_by_patient","_rev":"1-f2865c74eefee716937492db914f2ccd","version":4,"views":{"visit_by_patient":{"map":"function(doc) {\n    var doctype, uidx;\n    if (doc._id && (uidx = doc._id.indexOf('_')) > 0 && !doc.data.archived) {\n      doctype = doc._id.substring(0, uidx);\n      if (doctype === 'visit') {\n        var endDate = doc.data.endDate;\n    if (endDate && endDate !== \"\") {\n      endDate = new Date(endDate);\n      if (endDate.getTime) {\n        endDate = endDate.getTime();\n      }\n    }\n    var startDate = doc.data.startDate;\n    if (startDate && startDate !== \"\") {\n      startDate = new Date(startDate);\n      if (startDate.getTime) {\n        startDate = startDate.getTime();\n      }\n    }\n    emit([doc.data.patient, startDate, endDate, doc.data.visitType, doc._id]);\n      }\n    }\n  }"}}},{"_id":"customForm_2_ad1cb1f2-4fc0-4c9d-b35a-a0f988ce7c5e","_rev":"7-4d8d52bedb330ab142fd53abf67a6347","data":{"alwaysInclude":false,"columns":2,"formType":"incident","name":"Pre-Incident Risk Assessment","archived":false,"lastModified":"2017-03-08T20:11:20.017Z","modifiedBy":"Admin User","modifiedFields":{"name":"2017-03-08T20:11:20.017Z","formType":"2017-03-08T20:11:20.017Z","columns":"2017-03-08T20:11:20.017Z"},"fields":[{"classNames":null,"colSpan":1,"includeOtherOption":false,"label":"Severity","otherOptionLabel":null,"prompt":null,"property":"severity","type":"radio","values":[{"label":"5 Extreme Death, toxic release off-site with detrimental effect, huge financial loss"},{"label":"4 High Extensive injuries, loss of production capability, off-site release with no detrimental effects, major financial loss"},{"label":"3 Moderate Medical treatment required, on-site release contained with outside assistance, high financial loss"},{"label":"2 Low First aid treatment, on-site release contained, medium financial loss"},{"label":"1 Minimum No injuries, low financial loss"}]},{"classNames":null,"colSpan":1,"includeOtherOption":false,"label":"Occurrence","otherOptionLabel":null,"prompt":null,"property":"occurrence","type":"radio","values":[{"label":"5  Almost Certain  Is expected to occur in most circumstances (e.g. most weeks or months)"},{"label":"4  Likely Will probably occur in most circumstances (several times a year)"},{"label":"3  Possible Might occur at some time (every 1 to 2 years)"},{"label":"2  Unlikely Could occur at some time (possibly in the next 2 to 5 years)"},{"label":"1  Rare May occur only in exceptional circumstances (perhaps every 5 to 30 years)"}]}]},"_revisions":{"start":7,"ids":["4d8d52bedb330ab142fd53abf67a6347","144ce899e9db5fc2300996da9fe6c0ab","8f368fdc9d9dbce5b4d2b90210f2bcb9","8073815fa73f6990e7bb2deb77fb12a7","414d73feddcf40f5a1fd167969c3a602","c8b7a441091612c4489f99c9bd57cd92","f8a4799a21ece3f03578fb51669a0728"]}},{"_id":"customForm_2_b5e70841-b78b-4155-9ab5-babc6e0f45d1","_rev":"2-0a9dc37a28abce63101be0fe49cc65c9","data":{"alwaysInclude":true,"columns":1,"formType":"incident","name":"Harm Score","archived":false,"lastModified":"2017-03-08T20:03:19.266Z","modifiedBy":"Admin User","modifiedFields":{"name":"2017-03-08T20:03:19.266Z","formType":"2017-03-08T20:03:19.266Z","columns":"2017-03-08T20:03:19.266Z","alwaysInclude":"2017-03-08T20:03:19.266Z"},"fields":[{"classNames":null,"colSpan":null,"includeOtherOption":false,"label":"Harm Score","otherOptionLabel":null,"prompt":null,"property":"harmScore","type":"radio","values":[{"label":"A   No Actual Event (Unsafe Condition)"},{"label":"B1  Near Miss - The event did not reach the individual because of chance alone."},{"label":"B2  Near Miss - The event did not reach the individual because of active recovery efforts by caregivers."},{"label":"C   The event reached the individual but did not cause harm."},{"label":"D   The event reached the individual and required additional monitoring or treatment to prevent harm."},{"label":"E   The individual experienced temporary harm and required treatment or intervention."},{"label":"F   The individual experienced temporary harm and required initial or prolonged hospitalization"},{"label":"G   The individual experienced permanent harm."},{"label":"H   The individual experienced permanent harm and required intervention necessary to sustain life (e.g. transfer to ICU)"},{"label":"I   The individual died."}]}]},"_revisions":{"start":2,"ids":["0a9dc37a28abce63101be0fe49cc65c9","022d3782509a2e39231098f91c4ff6e3"]}},{"_id":"incCategory_2_926014ae-09e8-4a84-b5ca-bf5b74e6a66e","_rev":"19-952fa439be55b5d05daac9b22036fcd8","data":{"incidentCategoryName":"Accident or Injury","archived":false,"lastModified":"2017-03-08T19:27:23.252Z","modifiedBy":"Admin User","modifiedFields":{"incidentCategoryName":"2017-03-08T19:27:23.252Z","incidentCategoryItems":"2017-03-08T19:27:23.252Z"},"incidentCategoryItems":[{"item":"Patient"},{"item":"Staff"},{"item":"Visitor"},{"item":"Other"}]},"_revisions":{"start":19,"ids":["952fa439be55b5d05daac9b22036fcd8","ff92925f5de774642b31741d1e719c72","62363351300b35a8ea08a76ebde70c78","0facd37c7353d2687b7e0016671e13ea","f488bef85e63a2cd37a4c8f87b124ad7","843d670f1505286c4776a2d31dd24a6d","4c640d62bf0def873d75c61cbbd1d028","4a60a36fa1a89745c9b463bc6a82ce63","62133b9c7b236b00c5afceb9ec237e35","1a668956ce9a132fd01b489af72ee2da","10073b164dc3b3d0327d54bfa1029893","deb532df62f7e43732f12a4e9048343f","5e02b2f9068bb01fa20174c45a191edd","adfad92715a125aff37b36a4146d1718","e6a883ee493837e4db871daec9502c38","6e9d1bdadecc23bc9a5784f933d757d1","2560c5753a67267ac7fb831242b66d36","a91da396124d6f02640966523267eff9","214dd63d68b1ee9c742814bad6a741c0"]}},{"_id":"incCategory_2_be540109-2e7a-4210-99f8-8ecc8229b121","_rev":"5-5aee5f81c211c37ad210e7bfd49b46f3","data":{"incidentCategoryName":"Patient Falls","archived":false,"lastModified":"2017-03-08T19:41:56.167Z","modifiedBy":"Admin User","modifiedFields":{"incidentCategoryName":"2017-03-08T19:41:56.167Z","incidentCategoryItems":"2017-03-08T19:41:56.167Z"},"incidentCategoryItems":[{"item":"From bed"},{"item":"Sitting in chair"},{"item":"Ambulating"},{"item":"Grounds of Facility"},{"item":"Other"}]},"_revisions":{"start":5,"ids":["5aee5f81c211c37ad210e7bfd49b46f3","32a8067d8f84878abf1cc54c3b2b7562","9ea62078a74699bf156bce2187bca7c7","7ec0ba317e5024a9b6f7c9515d543a8f","a329294e5cd5ab7be8b6e78f1284fc46"]}},{"_id":"incidentNote_2_6ce1b9e8-2059-4412-8fef-ac51ee66561e","_rev":"1-1ed671fa954a6f4fbf0076e547b6b4be","data":{"givenBy":"hradmin","givenByDisplayName":"Admin User","description":"The wet floor sign had fallen down.","dateRecorded":"2017-03-08T20:22:00.339Z","archived":false,"lastModified":"2017-03-08T20:22:30.894Z","modifiedBy":"Admin User","modifiedFields":{"dateRecorded":"2017-03-08T20:22:30.894Z","givenBy":"2017-03-08T20:22:30.894Z","givenByDisplayName":"2017-03-08T20:22:30.894Z","description":"2017-03-08T20:22:30.894Z"}}},{"_id":"incident_2_56c64d71-ba30-4271-b899-f6f6b031f589","_rev":"2-fbd6489e112bce980737221ce4ca8e14","data":{"categoryItem":"Patient","categoryName":"Accident or Injury","dateOfIncident":"2017-03-08T20:20:00.863Z","department":"Reception","description":"Patient fell on wet floor.","friendlyId":"i00001","modifiedByDisplayName":"Admin User","notificationSend":false,"reportedBy":"hradmin","reportedByDisplayName":"Admin User","reportedDate":"2017-03-08T20:20:31.863Z","reportedTo":"Jane Bagadonuts","sentinelEvent":false,"status":"Reported","archived":false,"lastModified":"2017-03-08T20:21:30.499Z","modifiedBy":"Admin User","patientImpacted":null,"notes":["6ce1b9e8-2059-4412-8fef-ac51ee66561e"],"incidentAttachments":[],"modifiedFields":{"dateOfIncident":"2017-03-08T20:21:30.499Z","reportedDate":"2017-03-08T20:21:30.499Z","reportedBy":"2017-03-08T20:21:30.499Z","reportedByDisplayName":"2017-03-08T20:21:30.499Z","department":"2017-03-08T20:21:30.499Z","reportedTo":"2017-03-08T20:21:30.499Z","categoryName":"2017-03-08T20:21:30.499Z","categoryItem":"2017-03-08T20:21:30.499Z","description":"2017-03-08T20:21:30.499Z","modifiedByDisplayName":"2017-03-08T20:21:30.499Z","friendlyId":"2017-03-08T20:21:30.499Z"}},"_revisions":{"start":2,"ids":["fbd6489e112bce980737221ce4ca8e14","36a17cc165199d68f908d79841621edd"]}},{"_id":"lookup_2_incident_departments","_rev":"7-346b2f2d9db9396502eb24c702373816","data":{"organizeByType":false,"userCanAdd":true,"value":["Administrative Services","Laboratory","Operating Room","Pediatrics Clinic","Pharmacy","Radiology","Reception"]},"_revisions":{"start":7,"ids":["346b2f2d9db9396502eb24c702373816","705e350dc09fb1c8908c4b6106dfc82e","fbbbb0174932b837737db7ddfc8261e2","ab2df2af7b4c4d655535447ca7d67197","0268278fcfb97968347cf7d5b032c1c0","555e3dbd01a1e3a9f6b88c9b5c492d0d","c202d062450e1a8de13f65be9af8547c"]}},{"_id":"patient_2_965a8c39-81a3-42b5-9881-b7ad7da127d6","_rev":"2-b1e88abd56b3cad463a57905e06a7c76","data":{"admitted":false,"address":null,"address2":null,"address3":null,"address4":null,"bloodType":null,"clinic":null,"country":null,"checkedIn":false,"customForms":{},"dateOfBirth":"2016-06-07T04:00:00.000Z","economicClassification":null,"email":null,"externalPatientId":null,"familySupport1":null,"familySupport2":null,"familySupport3":null,"familySupport4":null,"familySupport5":null,"friendlyId":"P00001","firstName":"Joe","sex":"Male","occupation":null,"history":null,"insurance":null,"lastName":"Bagadonuts","livingArrangement":null,"middleName":"","notes":null,"otherIncome":null,"patientType":null,"parent":null,"phone":null,"placeOfBirth":null,"referredDate":null,"referredBy":null,"religion":null,"socialActionTaken":null,"socialRecommendation":null,"status":null,"archived":false,"lastModified":"2017-03-08T20:16:00.826Z","modifiedBy":"Admin User","paymentProfile":null,"payments":[],"operativePlans":[],"operationReports":[],"diagnoses":[],"allergies":[],"modifiedFields":{"customForms":"2017-03-08T20:15:35.198Z","firstName":"2017-03-08T20:15:35.198Z","middleName":"2017-03-08T20:15:35.198Z","lastName":"2017-03-08T20:15:35.198Z","friendlyId":"2017-03-08T20:15:35.198Z","sex":"2017-03-08T20:16:00.826Z","dateOfBirth":"2017-03-08T20:16:00.826Z"}},"_revisions":{"start":2,"ids":["b1e88abd56b3cad463a57905e06a7c76","0492d9142db03aa6d3434f2a3a64053e"]}}]}
{"seq":76}
